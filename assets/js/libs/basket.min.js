!function(e,t){"use strict";var n=t.head||t.getElementsByTagName("head")[0],r="basket-",u=5e3,a=[],i=function(e,t){try{return localStorage.setItem(r+e,JSON.stringify(t)),!0}catch(n){if(n.name.toUpperCase().indexOf("QUOTA")>=0){var u,a=[];for(u in localStorage)0===u.indexOf(r)&&a.push(JSON.parse(localStorage[u]));return a.length?(a.sort(function(e,t){return e.stamp-t.stamp}),basket.remove(a[0].key),i(e,t)):void 0}return}},o=function(e){var t=new RSVP.Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||0===r.status&&r.responseText?t({content:r.responseText,type:r.getResponseHeader("content-type")}):n(new Error(r.statusText)))},setTimeout(function(){r.readyState<4&&r.abort()},basket.timeout),r.send()});return t},s=function(e){return o(e.url).then(function(t){var n=c(e,t);return e.skipCache||i(e.key,n),n})},c=function(e,t){var n=+new Date;return e.data=t.content,e.originalType=t.type,e.type=e.type||t.type,e.skipCache=e.skipCache||!1,e.stamp=n,e.expire=n+60*(e.expire||u)*60*1e3,e},l=function(e,t){return!e||e.expire-+new Date<0||t.unique!==e.unique||basket.isValidItem&&!basket.isValidItem(e,t)},f=function(e){var t,n,r;if(e.url)return e.key=e.key||e.url,t=basket.get(e.key),e.execute=e.execute!==!1,r=l(t,e),e.live||r?(e.unique&&(e.url+=(e.url.indexOf("?")>0?"&":"?")+"basket-unique="+e.unique),n=s(e),e.live&&!r&&(n=n.then(function(e){return e},function(){return t}))):(t.type=e.type||t.originalType,t.execute=e.execute,n=new RSVP.Promise(function(e){e(t)})),n},p=function(e){var r=t.createElement("script");r.defer=!0,r.text=e.data,n.appendChild(r)},m={"default":p},g=function(e){return e.type&&m[e.type]?m[e.type](e):m["default"](e)},d=function(e){return e.map(function(e){return e.execute&&g(e),e})},h=function(){var e,t,n=[];for(e=0,t=arguments.length;t>e;e++)n.push(f(arguments[e]));return RSVP.all(n)},y=function(){var e=h.apply(null,arguments),t=this.then(function(){return e}).then(d);return t.thenRequire=y,t};e.basket={require:function(){for(var e=0,t=arguments.length;t>e;e++)arguments[e].execute=arguments[e].execute!==!1,arguments[e].once&&a.indexOf(arguments[e].url)>=0?arguments[e].execute=!1:arguments[e].execute!==!1&&a.indexOf(arguments[e].url)<0&&a.push(arguments[e].url);var n=h.apply(null,arguments).then(d);return n.thenRequire=y,n},remove:function(e){return localStorage.removeItem(r+e),this},get:function(e){var t=localStorage.getItem(r+e);try{return JSON.parse(t||"false")}catch(n){return!1}},clear:function(e){var t,n,u=+new Date;for(t in localStorage)n=t.split(r)[1],n&&(!e||this.get(n).expire<=u)&&this.remove(n);return this},isValidItem:null,timeout:5e3,addHandler:function(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(e){m[e]=t})},removeHandler:function(e){basket.addHandler(e,void 0)}},basket.clear(!0)}(this,document);